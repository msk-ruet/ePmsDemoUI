<!DOCTYPE html>
<html lang="en" x-data="{ 
  sidebarOpen: false, 
  darkMode: localStorage.getItem('darkMode') === 'true',
  sidebarCollapsed: localStorage.getItem('sidebarCollapsed') === 'true',
  activeMenu: null
}" x-init="
  $watch('darkMode', val => {
    localStorage.setItem('darkMode', val);
    document.documentElement.classList.toggle('dark', val);
  });
  $watch('sidebarCollapsed', val => localStorage.setItem('sidebarCollapsed', val));
  if (darkMode) {
    document.documentElement.classList.add('dark');
  }
" :class="{ 'dark': darkMode }">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DIU Sun Light Admin Console</title>

  <!-- Essential CSS & JS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            'sidebar-blue': '#034ea2',
            'table-blue': '#2E3094',
            'table-bg': '#F7F9FB',
            'edit-green': '#39b54a',
            'delete-red': '#c9252c',
            'dark-primary': '#22246f',
            'dark-secondary': '#2c2ea3',
            'dark-accent': '#3a3ccf',
            'pending-orange': '#FF9800',
            'approved-green': '#4CAF50',
            'sentback-red': '#F44336',
          },
          fontFamily: {
            'roboto': ['Roboto', 'sans-serif'],
          }
        }
      }
    }
  </script>
  
  <style>
    body {
      font-family: 'Roboto', sans-serif;
    }
    
    /* Sidebar collapse transitions */
    .sidebar-transition {
      transition: width 0.3s ease;
    }
    
    .text-transition {
      transition: opacity 0.2s ease;
    }
    
    .tooltip {
      position: relative;
    }
    
    .tooltip .tooltip-text {
      visibility: hidden;
      width: max-content;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 4px;
      padding: 5px 10px;
      position: absolute;
      z-index: 1;
      left: 100%;
      top: 50%;
      transform: translateY(-50%);
      margin-left: 8px;
      opacity: 0;
      transition: opacity 0.3s;
      white-space: nowrap;
    }
    
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    /* Submenu styling for collapsed mode */
    .menu-item-wrapper {
      position: relative;
    }
    
    .submenu-collapsed {
      position: fixed;
      left: 64px;
      background: white;
      border-radius: 0 8px 8px 0;
      box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.1);
      z-index: 45;
      min-width: 200px;
      max-height: 70vh;
      overflow-y: auto;
      border: 1px solid #e5e7eb;
      border-left: none;
    }
    
    .dark .submenu-collapsed {
      background: #2c2ea3;
      border-color: #3a3ccf;
      color: #e4e6ff;
    }
    
    .submenu-item {
      padding: 10px 16px;
      display: flex;
      align-items: center;
      cursor: pointer;
      transition: background-color 0.2s;
      border-bottom: 1px solid #f3f4f6;
      white-space: nowrap;
    }
    
    .dark .submenu-item {
      border-bottom-color: #3a3ccf;
      color: #e4e6ff;
    }
    
    .submenu-item:last-child {
      border-bottom: none;
    }
    
    .submenu-item:hover {
      background-color: #f3f4f6;
    }
    
    .dark .submenu-item:hover {
      background-color: #3a3ccf;
    }
    
    .submenu-item .material-symbols-outlined {
      margin-right: 12px;
      font-size: 18px;
    }
    
    /* Hide scrollbar but allow scrolling for main sidebar */
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    
    /* Active menu indicator */
    .active-menu-indicator {
      position: absolute;
      right: -8px;
      top: 50%;
      transform: translateY(-50%);
      width: 4px;
      height: 20px;
      background-color: #6366f1;
      border-radius: 2px;
    }

    /* Dark mode specific styles */
    .dark {
      color-scheme: dark;
    }
    
    .dark .bg-gray-50 {
      background-color: #111827;
    }
    
    .dark .bg-white {
      background-color: #22246f !important;
    }
    
    .dark .bg-gray-800 {
      background-color: #22246f !important;
    }
    
    .dark .bg-gray-700 {
      background-color: #2c2ea3 !important;
    }
    
    .dark .text-gray-800 {
      color: #f9fafb;
    }
    
    .dark .border-gray-200 {
      border-color: #3a3ccf;
    }
    
    .dark .border-gray-700 {
      border-color: #3a3ccf;
    }
    
    .dark .border-gray-100 {
      border-color: #3a3ccf;
    }
    
    .dark .bg-gray-100 {
      background-color: #2c2ea3;
    }
    
    .dark .text-gray-600 {
      color: #e4e6ff;
    }
    
    .dark .text-gray-700 {
      color: #e4e6ff;
    }
    
    .dark .text-gray-200 {
      color: #e4e6ff;
    }
    
    .dark .text-gray-300 {
      color: #e4e6ff;
    }
    
    .dark .text-gray-400 {
      color: #c7c9ff;
    }
    
    .dark .hover\:text-indigo-500:hover {
      color: #a5b4fc;
    }
    
    .dark .hover\:bg-indigo-900\/40:hover {
      background-color: #2c2ea3 !important;
    }
    
    .dark .hover\:bg-gray-700:hover {
      background-color: #2c2ea3 !important;
    }
    
    /* Custom hover effects for dark mode */
    .dark .hover\:bg-indigo-50:hover {
      background-color: #2c2ea3 !important;
    }

    /* KPI Table Styles */
    .progress-bar {
      height: 6px;
      border-radius: 3px;
      background-color: #e5e7eb;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      transition: width 0.3s ease;
    }

    .comment-input {
      width: 100%;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      padding: 6px;
      font-size: 0.75rem;
      resize: vertical;
      min-height: 50px;
    }

    .send-btn {
      background-color: #2E3094;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 6px 12px;
      font-size: 0.8rem;
      cursor: pointer;
      margin-top: 8px;
    }

    .send-btn:hover {
      background-color: #1e2074;
    }

    .score-input {
      width: 100%;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      padding: 3px;
      font-size: 0.75rem;
    }

    .table-container {
      overflow-x: auto;
    }

    .compact-table th,
    .compact-table td {
      padding: 6px 8px !important;
    }

    .action-btn {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.7rem;
      margin-right: 4px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .details-btn {
      background-color: #2E3094;
      color: white;
      border: none;
    }

    .details-btn:hover {
      background-color: #1e2074;
    }

    .kra-cell {
      background-color: white
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: white;
      border-radius: 8px;
      width: 90%;
      max-width: 1500px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .status-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.7rem;
      font-weight: 500;
      margin-left: 8px;
    }

    .status-approved {
      background-color: #d1fae5;
      color: #065f46;
    }

    .status-sent-back {
      background-color: #fee2e2;
      color: #991b1b;
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      padding: 16px;
      border-top: 1px solid #e5e7eb;
    }

    .modal-btn {
      padding: 8px 16px;
      border-radius: 4px;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .modal-submit {
      background-color: #2E3094;
      color: white;
      border: none;
    }

    .modal-submit:hover {
      background-color: #1e2074;
    }

    .modal-cancel {
      background-color: #f3f4f6;
      color: #374151;
      border: 1px solid #d1d5db;
    }

    .modal-cancel:hover {
      background-color: #e5e7eb;
    }

    @media (max-width: 768px) {
      .table-container table {
        font-size: 0.7rem;
      }

      .compact-table th,
      .compact-table td {
        padding: 4px 6px !important;
      }
      
      .action-btn {
        display: block;
        width: 100%;
        margin-bottom: 4px;
      }

      .modal-actions {
        flex-direction: column;
      }
      .comment-history {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .comment-item {
            border-left: 3px solid #0089CF;
            padding-left: 10px;
            margin-bottom: 10px;
        }
        
        .comment-item.approved {
            border-left-color: #39b54a;
        }
        
        .comment-item.send-back {
            border-left-color: #c9252c;
        }
        .evidence-url {
            color: #0089CF;
            text-decoration: underline;
            word-break: break-all;
        }
    }
  </style>
</head>

<body class="bg-gray-50 text-gray-800 transition-colors duration-300"
      x-data="{}"
      @click="activeMenu = null">

<div class="flex h-screen overflow-hidden">

  <!-- Sidebar -->
  <aside
          class="fixed inset-y-0 left-0 z-40 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-300 sidebar-transition
           md:translate-x-0"
          :class="sidebarCollapsed ? 'w-16' : 'w-64'"
          :class="{ '-translate-x-full': !sidebarOpen && window.innerWidth < 768 }"
          @click.stop>

    <!-- Logo -->
    <div class="flex items-center justify-between px-4 py-2 border-b border-gray-200 dark:border-gray-700">
      <div class="flex items-center">
        <h1 class="text-lg font-bold text-indigo-600 dark:text-indigo-300"
            :class="sidebarCollapsed ? 'hidden' : 'block'">DIU Sun Light</h1>
        <button
                @click="sidebarCollapsed = !sidebarCollapsed; activeMenu = null;"
                class="ml-2 text-gray-600 dark:text-gray-300 hover:text-indigo-500 p-1 rounded"
                :title="sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'">
          <span class="material-symbols-outlined"
                x-text="sidebarCollapsed ? 'chevron_right' : 'chevron_left'"></span>
        </button>
      </div>
      <button class="md:hidden text-gray-600 dark:text-gray-300" @click="sidebarOpen = false">âœ•</button>
    </div>

    <!-- Navigation -->
    <nav class="overflow-y-auto p-4 space-y-2 no-scrollbar">

      <!-- Dashboard -->
      <div class="menu-item-wrapper">
        <a href="index.html"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 tooltip relative"
           :class="{ 'bg-indigo-50 dark:bg-gray-700': activeMenu === 'dashboard' }">
          <span class="material-symbols-outlined mr-3">dashboard</span>
          <span class="text-transition"
                :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">Dashboard</span>
          <span class="tooltip-text" x-show="sidebarCollapsed">Dashboard</span>
          <div class="active-menu-indicator" x-show="sidebarCollapsed && activeMenu === 'dashboard'"></div>
        </a>
      </div>

      <!-- User Management -->
      <div x-data="{ open: false }" class="menu-item-wrapper">
        <button
                @click="if (sidebarCollapsed) {
          activeMenu = activeMenu === 'user-management' ? null : 'user-management';
        } else { 
          open = !open; 
        }"
                class="flex items-center justify-between w-full px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 tooltip relative"
                :class="{ 'bg-indigo-50 dark:bg-gray-700': activeMenu === 'user-management' }">
          <div class="flex items-center">
            <span class="material-symbols-outlined mr-3">group</span>
            <span class="text-transition" :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">User Management</span>
          </div>
          <span class="material-symbols-outlined text-sm transition-transform"
                :class="open ? 'rotate-180' : ''"
                x-show="!sidebarCollapsed">expand_more</span>
          <span class="tooltip-text" x-show="sidebarCollapsed">User Management</span>
          <div class="active-menu-indicator"
               x-show="sidebarCollapsed && activeMenu === 'user-management'"></div>
        </button>

        <!-- Expanded Mode Submenu -->
        <div x-show="open && !sidebarCollapsed" x-collapse class="pl-10 mt-1 space-y-1">
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">person</span> Users
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">admin_panel_settings</span> Roles
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">history</span> Audit Logs
          </a>
        </div>

        <!-- Collapsed Mode Submenu -->
        <div x-show="sidebarCollapsed && activeMenu === 'user-management'"
             class="submenu-collapsed"
             :style="`top: ${$el.parentElement.offsetTop}px;`"
             @click.stop>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">person</span>
            Users
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">admin_panel_settings</span>
            Roles
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">history</span>
            Audit Logs
          </div>
        </div>
      </div>

      <!-- HR & Attendance -->
      <div x-data="{ open: false }" class="menu-item-wrapper">
        <button
                @click="if (sidebarCollapsed) {
          activeMenu = activeMenu === 'hr-attendance' ? null : 'hr-attendance';
        } else { 
          open = !open; 
        }"
                class="flex items-center justify-between w-full px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 tooltip relative"
                :class="{ 'bg-indigo-50 dark:bg-gray-700': activeMenu === 'hr-attendance' }">
          <div class="flex items-center">
            <span class="material-symbols-outlined mr-3">calendar_month</span>
            <span class="text-transition" :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">HR & Attendance</span>
          </div>
          <span class="material-symbols-outlined text-sm transition-transform"
                :class="open ? 'rotate-180' : ''"
                x-show="!sidebarCollapsed">expand_more</span>
          <span class="tooltip-text" x-show="sidebarCollapsed">HR & Attendance</span>
          <div class="active-menu-indicator"
               x-show="sidebarCollapsed && activeMenu === 'hr-attendance'"></div>
        </button>

        <!-- Expanded Mode Submenu -->
        <div x-show="open && !sidebarCollapsed" x-collapse class="pl-10 mt-1 space-y-1">
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">badge</span> Employees
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">schedule</span> Attendance
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">timer</span> Overtime
          </a>
        </div>

        <!-- Collapsed Mode Submenu -->
        <div x-show="sidebarCollapsed && activeMenu === 'hr-attendance'"
             class="submenu-collapsed"
             :style="`top: ${$el.parentElement.offsetTop}px;`"
             @click.stop>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">badge</span>
            Employees
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">schedule</span>
            Attendance
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">timer</span>
            Overtime
          </div>
        </div>
      </div>

        <!-- ePMS -->
        <div x-data="{ open: false }" class="menu-item-wrapper">
            <button
                    @click="if (sidebarCollapsed) {
              activeMenu = activeMenu === 'epms' ? null : 'epms';
            } else {
              open = !open;
            }"
                    class="flex items-center justify-between w-full px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-indigo-900/40 text-gray-700 dark:text-gray-200 tooltip relative"
                    :class="{ 'bg-indigo-50 dark:bg-indigo-900/40': activeMenu === 'epms' }">
                <div class="flex items-center">
                    <span class="material-symbols-outlined mr-3">assignment</span>
                    <span class="text-transition"
                          :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">ePMS</span>
                </div>
                <span class="material-symbols-outlined text-sm transition-transform"
                      :class="open ? 'rotate-180' : ''"
                      x-show="!sidebarCollapsed">expand_more</span>
                <span class="tooltip-text" x-show="sidebarCollapsed">ePMS</span>
                <div class="active-menu-indicator" x-show="sidebarCollapsed && activeMenu === 'epms'"></div>
            </button>

            <!-- Expanded Mode Submenu -->
            <div x-show="open && !sidebarCollapsed" x-collapse class="pl-10 mt-1 space-y-1">

                <a href="kpiAssign.html"
                   class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
                    <span class="material-symbols-outlined mr-2 text-base">task</span> KPI Assign
                </a>
                <a href="myKpi.html"
                   class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
                    <span class="material-symbols-outlined mr-2 text-base">trending_up</span> My KPI
                </a>
                <a href="kpiReview.html"
                   class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
                    <span class="material-symbols-outlined mr-2 text-base">target</span> KPI Review
                </a>

                <a href="kpiReports.html"
                   class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
                    <span class="material-symbols-outlined mr-2 text-base">summarize</span> KPI Reports
                </a>
            </div>

            <!-- Collapsed Mode Submenu -->
            <div x-show="sidebarCollapsed && activeMenu === 'epms'"
                 class="submenu-collapsed"
                 :style="`top: ${$el.parentElement.offsetTop}px;`"
                 @click.stop>
                <div class="submenu-item" @click="activeMenu = null">
                    <a href="kpiAssign.html"
                       class="flex items-center text-sm py-1">
                        <span class="material-symbols-outlined mr-2 text-base">task</span> KPI Assign
                    </a>
                </div>
                <div class="submenu-item" @click="activeMenu = null">
                    <a href="myKpi.html"
                       class="flex items-center text-sm py-1">
                        <span class="material-symbols-outlined mr-2 text-base">trending_up</span> My KPI
                    </a>
                </div>
                <div class="submenu-item" @click="activeMenu = null">
                    <a href="kpiReview.html"
                       class="flex items-center text-sm py-1">
                        <span class="material-symbols-outlined mr-2 text-base">target</span> KPI Review
                    </a>
                </div>
                <div class="submenu-item" @click="activeMenu = null">
                    <a href="kpiReports.html"
                       class="flex items-center text-sm py-1">
                        <span class="material-symbols-outlined">summarize</span> KPI Reports
                    </a>
                </div>
            </div>
        </div>

      <!-- Payroll -->
      <div x-data="{ open: false }" class="menu-item-wrapper">
        <button
                @click="if (sidebarCollapsed) {
          activeMenu = activeMenu === 'payroll' ? null : 'payroll';
        } else { 
          open = !open; 
        }"
                class="flex items-center justify-between w-full px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 tooltip relative"
                :class="{ 'bg-indigo-50 dark:bg-gray-700': activeMenu === 'payroll' }">
          <div class="flex items-center">
            <span class="material-symbols-outlined mr-3">payments</span>
            <span class="text-transition" :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">Payroll</span>
          </div>
          <span class="material-symbols-outlined text-sm transition-transform"
                :class="open ? 'rotate-180' : ''"
                x-show="!sidebarCollapsed">expand_more</span>
          <span class="tooltip-text" x-show="sidebarCollapsed">Payroll</span>
          <div class="active-menu-indicator" x-show="sidebarCollapsed && activeMenu === 'payroll'"></div>
        </button>

        <!-- Expanded Mode Submenu -->
        <div x-show="open && !sidebarCollapsed" x-collapse class="pl-10 mt-1 space-y-1">
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">receipt</span> Salary Processing
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">request_quote</span> Payslips
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">savings</span> Tax Management
          </a>
        </div>

        <!-- Collapsed Mode Submenu -->
        <div x-show="sidebarCollapsed && activeMenu === 'payroll'"
             class="submenu-collapsed"
             :style="`top: ${$el.parentElement.offsetTop}px;`"
             @click.stop>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">receipt</span>
            Salary Processing
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">request_quote</span>
            Payslips
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">savings</span>
            Tax Management
          </div>
        </div>
      </div>

      <!-- Leave -->
      <div x-data="{ open: false }" class="menu-item-wrapper">
        <button
                @click="if (sidebarCollapsed) {
          activeMenu = activeMenu === 'leave' ? null : 'leave';
        } else { 
          open = !open; 
        }"
                class="flex items-center justify-between w-full px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 tooltip relative"
                :class="{ 'bg-indigo-50 dark:bg-gray-700': activeMenu === 'leave' }">
          <div class="flex items-center">
            <span class="material-symbols-outlined mr-3">beach_access</span>
            <span class="text-transition"
                  :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">Leave</span>
          </div>
          <span class="material-symbols-outlined text-sm transition-transform"
                :class="open ? 'rotate-180' : ''"
                x-show="!sidebarCollapsed">expand_more</span>
          <span class="tooltip-text" x-show="sidebarCollapsed">Leave</span>
          <div class="active-menu-indicator" x-show="sidebarCollapsed && activeMenu === 'leave'"></div>
        </button>

        <!-- Expanded Mode Submenu -->
        <div x-show="open && !sidebarCollapsed" x-collapse class="pl-10 mt-1 space-y-1">
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">event_available</span> Apply Leave
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">pending_actions</span> Leave Requests
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">calendar_today</span> Leave Calendar
          </a>
        </div>

        <!-- Collapsed Mode Submenu -->
        <div x-show="sidebarCollapsed && activeMenu === 'leave'"
             class="submenu-collapsed"
             :style="`top: ${$el.parentElement.offsetTop}px;`"
             @click.stop>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">event_available</span>
            Apply Leave
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">pending_actions</span>
            Leave Requests
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">calendar_today</span>
            Leave Calendar
          </div>
        </div>
      </div>

      <!-- Visit -->
      <div x-data="{ open: false }" class="menu-item-wrapper">
        <button
                @click="if (sidebarCollapsed) {
          activeMenu = activeMenu === 'visit' ? null : 'visit';
        } else { 
          open = !open; 
        }"
                class="flex items-center justify-between w-full px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 tooltip relative"
                :class="{ 'bg-indigo-50 dark:bg-gray-700': activeMenu === 'visit' }">
          <div class="flex items-center">
            <span class="material-symbols-outlined mr-3">travel_explore</span>
            <span class="text-transition"
                  :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">Visit</span>
          </div>
          <span class="material-symbols-outlined text-sm transition-transform"
                :class="open ? 'rotate-180' : ''"
                x-show="!sidebarCollapsed">expand_more</span>
          <span class="tooltip-text" x-show="sidebarCollapsed">Visit</span>
          <div class="active-menu-indicator" x-show="sidebarCollapsed && activeMenu === 'visit'"></div>
        </button>

        <!-- Expanded Mode Submenu -->
        <div x-show="open && !sidebarCollapsed" x-collapse class="pl-10 mt-1 space-y-1">
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">person_search</span> Visitor Registration
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">meeting_room</span> Meeting Rooms
          </a>
          <a href="#"
             class="flex items-center text-sm py-1 hover:text-indigo-500 text-gray-600 dark:text-gray-300">
            <span class="material-symbols-outlined mr-2 text-base">schedule</span> Visit Schedule
          </a>
        </div>

        <!-- Collapsed Mode Submenu -->
        <div x-show="sidebarCollapsed && activeMenu === 'visit'"
             class="submenu-collapsed"
             :style="`top: ${$el.parentElement.offsetTop}px;`"
             @click.stop>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">person_search</span>
            Visitor Registration
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">meeting_room</span>
            Meeting Rooms
          </div>
          <div class="submenu-item" @click="activeMenu = null">
            <span class="material-symbols-outlined">schedule</span>
            Visit Schedule
          </div>
        </div>
      </div>

      <!-- Reports -->
      <div class="menu-item-wrapper">
        <a href="#"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 tooltip relative"
           :class="{ 'bg-indigo-50 dark:bg-gray-700': activeMenu === 'reports' }">
          <span class="material-symbols-outlined mr-3">bar_chart</span>
          <span class="text-transition"
                :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">Reports</span>
          <span class="tooltip-text" x-show="sidebarCollapsed">Reports</span>
          <div class="active-menu-indicator" x-show="sidebarCollapsed && activeMenu === 'reports'"></div>
        </a>
      </div>

      <!-- Settings -->
      <div class="menu-item-wrapper">
        <a href="#"
           class="flex items-center px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 tooltip relative"
           :class="{ 'bg-indigo-50 dark:bg-gray-700': activeMenu === 'settings' }">
          <span class="material-symbols-outlined mr-3">settings</span>
          <span class="text-transition"
                :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">Settings</span>
          <span class="tooltip-text" x-show="sidebarCollapsed">Settings</span>
          <div class="active-menu-indicator" x-show="sidebarCollapsed && activeMenu === 'settings'"></div>
        </a>
      </div>
    </nav>

    <!-- Footer -->
    <div class="border-t border-gray-200 dark:border-gray-700 p-4">
      <button class="flex items-center w-full text-gray-700 dark:text-gray-200 tooltip">
        <span class="material-symbols-outlined mr-2">logout</span>
        <span class="text-transition" :class="sidebarCollapsed ? 'opacity-0 w-0' : 'opacity-100'">Logout</span>
        <span class="tooltip-text" x-show="sidebarCollapsed">Logout</span>
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col sidebar-transition" :class="sidebarCollapsed ? 'md:ml-16' : 'md:ml-64'">

    <!-- Top Navbar -->
    <header
            class="flex items-center justify-between bg-white dark:bg-gray-800 shadow-sm px-4 py-3 sticky top-0 z-30 border-b border-gray-100 dark:border-gray-700">
      <div class="flex items-center gap-2">
        <button @click="sidebarOpen = !sidebarOpen" class="md:hidden text-gray-600 dark:text-gray-300">
          â˜°
        </button>
        <input type="text" placeholder="Search..."
               class="hidden md:block px-3 py-1 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 text-sm outline-none"/>
      </div>

      <!-- Right Actions -->
      <div class="flex items-center gap-4">
        <!-- Dark Mode Toggle -->
        <button @click="darkMode = !darkMode" class="text-gray-600 dark:text-gray-300 hover:text-indigo-500">
          <span x-show="!darkMode" class="material-symbols-outlined">light_mode</span>
          <span x-show="darkMode" class="material-symbols-outlined">dark_mode</span>
        </button>

        <!-- Notifications -->
        <button class="text-gray-600 dark:text-gray-300 hover:text-indigo-500">
          <span class="material-symbols-outlined">notifications</span>
        </button>

        <!-- Admin Dropdown -->
        <div x-data="{ open: false, role: 'Admin' }" class="relative">
          <button @click="open = !open" @mouseenter="open = true" @mouseleave="open = false"
                  class="flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:text-indigo-500">
            ðŸ‘¤ <span>Admin</span>
          </button>

          <!-- Dropdown -->
          <div x-show="open" x-transition @mouseenter="open = true" @mouseleave="open = false"
               class="absolute right-0 mt-2 w-44 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2">
            <div class="px-3 py-2 border-b border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200">
              Role: <span class="font-medium text-indigo-500" x-text="role"></span>
            </div>
            <a href="#" class="block px-3 py-2 text-sm hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200">Profile</a>
            <a href="#"
               class="block px-3 py-2 text-sm hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200">Settings</a>
            <a href="#" class="block px-3 py-2 text-sm hover:bg-indigo-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200">Logout</a>
          </div>
        </div>
      </div>
    </header>
    
    <!-- Main Content Area -->
    <main class="flex-1 p-4 overflow-auto">
      <!-- KPI Content -->
      <div id="kpisContent" class="tab-content">
        <!-- Table -->
        <div class="bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden">
          <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200">Key Performance Indicator (2026)</h3>
          </div>

          <div class="table-container">
            <table class="min-w-full compact-table" id="kpiTable">
              <thead>
                <tr class="bg-table-blue text-white">
                  <th rowspan="2" width="3%"
                      class="px-2 py-2 text-center text-xs font-medium uppercase tracking-wider border-l border-r border-blue-500">
                    SL</th>
                  <th rowspan="2" width="10%"
                      class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-l border-r border-blue-500">
                    KRA</th>
                  <th width="15%"
                      class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                    KPI</th>
                  <th width="6%"
                      class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                    Weightage</th>
                  <th width="8%"
                      class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                    Target Description</th>
                  <th width="8%"
                      class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                    Target (Numeric)</th>
                  <th width="8%"
                      class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                    Achievement</th>
                  <th width="8%"
                      class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                    Achievement (%)</th>
                  <th width="8%"
                      class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                    Score</th>
                  <th width="5%"
                      class="px-2 py-2 text-center text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                    â‹®</th>
                </tr>
              </thead>
              <tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600" id="kpiTableBody">
                <!-- Performance KRA -->
                <tr class="kpi-row saved" data-kra-id="1">
                  <td rowspan="3" class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 align-top border-l border-r border-gray-200 dark:border-gray-600 text-center kra-cell dark:bg-[#22246f] dark:text-white">
                    <div class="flex items-center justify-center h-full">
                      1
                    </div>
                  </td>
                  <td rowspan="3" class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 align-top border-l border-r border-gray-200 dark:border-gray-600 text-left kra-cell dark:bg-[#22246f] dark:text-white">
                    <div class="h-full">
                      Performance
                    </div>
                  </td>
                  <td class="px-2 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-b border-r border-gray-200 dark:border-gray-600">
                    Revenue Growth
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    30</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    Increase revenue by 15%</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    15</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">14
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    <div class="flex items-center">
                      <div class="progress-bar w-full">
                        <div class="progress-fill bg-green-600" style="width: 93%"></div>
                      </div>
                      <span class="ml-1 text-xs">93%</span>
                    </div>
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    27.9
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600 text-center">
                    <button class="action-btn details-btn" data-kpi-id="1">
                      Details
                    </button>
                  </td>
                </tr>
                <tr class="kpi-row saved" data-kra-id="1">
                  <td class="px-2 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-b border-r border-gray-200 dark:border-gray-600">
                    Cost Reduction
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    25</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    Reduce operational costs by 10%</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    10</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">9
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    <div class="flex items-center">
                      <div class="progress-bar w-full">
                        <div class="progress-fill bg-green-600" style="width: 90%"></div>
                      </div>
                      <span class="ml-1 text-xs">90%</span>
                    </div>
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    22.5
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600 text-center">
                    <button class="action-btn details-btn" data-kpi-id="2">
                      Details
                    </button>
                  </td>
                </tr>
                <tr class="kpi-row saved" data-kra-id="1">
                  <td class="px-2 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-b border-r border-gray-200 dark:border-gray-600">
                    Profit Margin
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    20</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    Achieve 22% profit margin</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    22</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">21
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    <div class="flex items-center">
                      <div class="progress-bar w-full">
                        <div class="progress-fill bg-green-600" style="width: 95%"></div>
                      </div>
                      <span class="ml-1 text-xs">95%</span>
                    </div>
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    19
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600 text-center">
                    <button class="action-btn details-btn" data-kpi-id="3">
                       Details
                    </button>
                  </td>
                </tr>
                
                <!-- Customer Satisfaction KRA -->
                <tr class="kpi-row saved" data-kra-id="2">
                  <td rowspan="2" class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 align-top border-l border-r border-gray-200 dark:border-gray-600 text-center kra-cell dark:bg-[#22246f] dark:text-white">
                    <div class="flex items-center justify-center h-full">
                      2
                    </div>
                  </td>
                  <td rowspan="2" class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 align-top border-l border-r border-gray-200 dark:border-gray-600 text-left kra-cell dark:bg-[#22246f] dark:text-white">
                    <div class="h-full">
                      Customer Satisfaction
                    </div>
                  </td>
                  <td class="px-2 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-b border-r border-gray-200 dark:border-gray-600">
                    NPS Score
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    15</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    Financial reporting process documentation</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    N/A</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">Exclent
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    <div class="flex items-center">
                      <div class="progress-bar w-full">
                        <div class="progress-fill bg-green-600" style="width: 100%"></div>
                      </div>
                      <span class="ml-1 text-xs">100%</span>
                    </div>
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    15
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600 text-center">
                    <button class="action-btn details-btn" data-kpi-id="4">
                       Details
                    </button>
                  </td>
                </tr>
                <tr class="kpi-row saved" data-kra-id="2">
                  <td class="px-2 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-b border-r border-gray-200 dark:border-gray-600">
                    Customer Retention
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    10</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    Maintain customer retention rate of 85%</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    85</td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">82
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    <div class="flex items-center">
                      <div class="progress-bar w-full">
                        <div class="progress-fill bg-green-600" style="width: 96%"></div>
                      </div>
                      <span class="ml-1 text-xs">96%</span>
                    </div>
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600">
                    9.6
                  </td>
                  <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border-b border-r border-gray-200 dark:border-gray-600 text-center">
                    <button class="action-btn details-btn" data-kpi-id="5">
                       Details
                    </button>
                  </td>
                </tr>
              </tbody>
              <tfoot>
                <tr class="weightage-total">
                  <td colspan="3" class="px-2 py-2 text-right font-medium text-gray-800 dark:text-gray-200">Total Weightage:</td>
                  <td id="totalWeightage" class="px-2 py-2 text-center font-medium text-gray-800 dark:text-gray-200">100</td>
                  <td colspan="4" class="px-2 py-2 text-center">
                    <span id="weightageStatus" class="text-sm text-green-600 dark:text-green-400"></span>
                  </td>
                  <td class="px-2 py-2 text-center font-medium text-gray-800 dark:text-gray-200">94</td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

<!-- KPI Review Modal -->
<div id="kpiReviewModal" class="modal">
  <div class="modal-content dark:bg-gray-800 dark:text-gray-200 pb-10">
    <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
      <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200">KPI Review (2026)</h3>
      <button id="closeModal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
        <i class="fas fa-times text-xl"></i>
      </button>
    </div>
    <div class="p-4">
      <!-- KPI Details Table -->
      <div class="mb-6">
        <h4 class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2">KPI Details</h4>
        <div class="overflow-x-auto">
          <table class="min-w-full compact-table">
            <thead>
              <tr class="bg-table-blue text-white">
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                  KRA</th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                  KPI</th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                  Weightage</th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                  Target Details</th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                  Target</th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                  Achievement</th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                  Achievement (%)</th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider border-r border-blue-500">
                  Score</th>
              </tr>
            </thead>
            <tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600" id="modalKpiDetails">
              <!-- KPI details will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    <div class="flex gap-4">
        <!-- Comment Box (Always Visible) -->
        <div class=" w-1/2">
            <!-- Evidence URL Section -->
            <div >
                <h4 class="text-md font-medium text-gray-800 mb-2">Achievement</h4>
                <input type="text" class="border border-gray-200 rounded p-3 w-full" placeholder="Enter your achievement">        
                </input>
            </div>
            <div >
                <h4 class="text-md font-medium text-gray-800 mb-2">Evidence URL</h4>
                <input type="text" class="border border-gray-200 rounded p-3 w-full" placeholder="Enter your url...">        
                </input>
            </div>
            <label for="commentText" class="text-lg font-medium text-gray-800">Add Comment</label>
            <textarea id="commentText" class="w-full border border-gray-300 rounded text-sm p-3" rows="5"
                placeholder="Enter your comments here..."></textarea>
            <!-- Action Buttons -->
            <div class="flex space-x-3">
                <button id="sendBackBtn"
                    class="bg-red-500 hover:bg-purple-600 text-white px-5 py-2 rounded text-sm transition-colors">
                    Submit
                </button>
                <button id="acceptBtn"
                    class="bg-green-500 hover:bg-green-600 text-white px-5 py-2 rounded text-sm transition-colors">
                    Resubmit
                </button>
            </div>
        </div>
        <!-- Comment History Section -->
        <div class=" w-1/2">
            <h4 class="text-lg font-medium text-gray-800 mb-2 ">Comment History</h4>
            <div class="bg-gray-50 rounded-lg overflow-y-auto p-3 max-h-60">
                <div class="space-y-4">
                    <!-- Sample Comment 1 -->
                    <div class="border-l-4 border-sentback-red pl-4 py-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-medium text-gray-800">John Doe (EMP001)</p>
                                <p class="text-sm text-gray-600">Please review the achievement numbers and provide more
                                    details.
                                </p>
                            </div>
                            <span class="bg-sentback-red text-white text-xs px-2 py-1 rounded">Sent Back</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">2 hours ago</p>
                    </div>
    
                    <!-- Sample Comment 2 -->
                    <div class="border-l-4 border-approved-green pl-4 py-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-medium text-gray-800">Sarah Smith (EMP002)</p>
                                <p class="text-sm text-gray-600">All KPI targets are met with proper documentation.</p>
                            </div>
                            <span class="bg-approved-green text-white text-xs px-2 py-1 rounded">Approved</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">1 day ago</p>
                    </div>
    
                    <!-- Sample Comment 3 -->
                    <div class="border-l-4 border-sentback-red pl-4 py-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-medium text-gray-800">Mike Johnson (EMP003)</p>
                                <p class="text-sm text-gray-600">Need clarification on the revenue growth calculation
                                    methodology.</p>
                            </div>
                            <span class="bg-sentback-red text-white text-xs px-2 py-1 rounded">Sent Back</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">3 days ago</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
  </div>
</div>

<script>
  // Modal functionality
  const modal = document.getElementById('kpiReviewModal');
  const closeModal = document.getElementById('closeModal');
  const detailsButtons = document.querySelectorAll('.details-btn');
  const modalKpiDetails = document.getElementById('modalKpiDetails');
  const sendCommentBtn = document.getElementById('sendComment');
  const submitBtn = document.getElementById('submitBtn');
  const cancelBtn = document.getElementById('cancelBtn');
  const commentHistory = document.getElementById('commentHistory');

  // KPI data for the modal
  const kpiData = {
    1: {
      kra: "Performance",
      kpi: "Revenue Growth",
      weightage: "30",
      targetDetails: "Increase revenue by 15%",
      target: "15",
      achievement: "14",
      achievementPercent: "93%",
      score: "27.9"
    },
    2: {
      kra: "Performance",
      kpi: "Cost Reduction",
      weightage: "25",
      targetDetails: "Reduce operational costs by 10%",
      target: "10",
      achievement: "9",
      achievementPercent: "90%",
      score: "22.5"
    },
    3: {
      kra: "Performance",
      kpi: "Profit Margin",
      weightage: "20",
      targetDetails: "Achieve 22% profit margin",
      target: "22",
      achievement: "21",
      achievementPercent: "95%",
      score: "19"
    },
    4: {
      kra: "Customer Satisfaction",
      kpi: "NPS Score",
      weightage: "15",
      targetDetails: "Financial reporting process documentation",
      target: "N/A",
      achievement: "Very Good",
      achievementPercent: "100%",
      score: "15"
    },
    5: {
      kra: "Customer Satisfaction",
      kpi: "Customer Retention",
      weightage: "10",
      targetDetails: "Maintain customer retention rate of 85%",
      target: "85",
      achievement: "82",
      achievementPercent: "96%",
      score: "9.6"
    }
  };

  // Open modal when details button is clicked
  detailsButtons.forEach(button => {
    button.addEventListener('click', function () {
      const kpiId = this.getAttribute('data-kpi-id');
      const kpi = kpiData[kpiId];
      
      // Populate modal with KPI details
      modalKpiDetails.innerHTML = `
        <tr>
          <td class="px-2 py-2 text-sm text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600">
            <div>${kpi.kra}</div>
          </td>
          <td class="px-2 py-2 text-sm text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600">
            <div >${kpi.kpi}</div>
          </td>
          <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600">
            ${kpi.weightage}
          </td>
          <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600">
            ${kpi.targetDetails}
          </td>
          <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600">
            ${kpi.target}
          </td>
          <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600">${kpi.achievement}
          </td>
          <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600">
            ${kpi.achievementPercent}
          </td>
          <td class="px-2 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 border border-gray-200 dark:border-gray-600">
            ${kpi.score}
          </td>
        </tr>
      `;
      
      // Show modal
      modal.style.display = 'flex';
    });
  });

  // Close modal
  closeModal.addEventListener('click', function() {
    modal.style.display = 'none';
  });

  // Cancel button
  cancelBtn.addEventListener('click', function() {
    modal.style.display = 'none';
  });

  // Submit button
  submitBtn.addEventListener('click', function() {
    const achievementValue = document.getElementById('modalAchievement').value;
    modal.style.display = 'none';
  });

  // Close modal when clicking outside
  window.addEventListener('click', function(event) {
    if (event.target === modal) {
      modal.style.display = 'none';
    }
  });

  // Send comment functionality
  sendCommentBtn.addEventListener('click', function() {
    const commentInput = document.getElementById('commentInput');
    const comment = commentInput.value.trim();
    
    if (comment) {
      // Create new comment element
      const newComment = document.createElement('div');
      newComment.className = 'comment-item mb-3 pb-3 border-b border-gray-200 dark:border-gray-600';
      
      // Get current date and time
      const now = new Date();
      const dateString = now.toISOString().split('T')[0];
      const timeString = now.toTimeString().split(' ')[0].substring(0, 5);
      
      newComment.innerHTML = `
        <div class="flex justify-between mb-1">
          <div class="flex items-center">
            <span class="font-medium text-sm">Admin User</span>
            <span class="status-badge status-approved">Approved</span>
          </div>
          <span class="text-xs text-gray-500 dark:text-gray-400">${dateString} ${timeString}</span>
        </div>
        <p class="text-sm">${comment}</p>
      `;
      
      // Add new comment to the top of the comment history
      commentHistory.insertBefore(newComment, commentHistory.firstChild);
      
      // Clear the input
      commentInput.value = '';
    } 
  });
</script>
</body>
</html>